{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 51, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USS-000/Documents/GitHub/SimCardio/lib/redis.js"],"sourcesContent":["/**\r\n * lib/redis.js\r\n * Cliente Upstash Redis compartido para toda la app Next.js\r\n * Next.js transpila este archivo autom√°ticamente mediante su bundler.\r\n */\r\nconst { Redis } = require('@upstash/redis');\r\n\r\nconst KV_KEY = 'simcardio:casos';\r\n\r\n// Fallback para desarrollo local sin Redis\r\nfunction isRedisConfigured() {\r\n    return !!(process.env.UPSTASH_REDIS_REST_URL && process.env.UPSTASH_REDIS_REST_TOKEN);\r\n}\r\n\r\nfunction getRedis() {\r\n    if (!isRedisConfigured()) return null;\r\n    return new Redis({\r\n        url: process.env.UPSTASH_REDIS_REST_URL,\r\n        token: process.env.UPSTASH_REDIS_REST_TOKEN,\r\n    });\r\n}\r\n\r\nasync function getCasos() {\r\n    const redis = getRedis();\r\n    if (redis) {\r\n        try {\r\n            const data = await redis.get(KV_KEY);\r\n            if (data) return Array.isArray(data) ? data : JSON.parse(data);\r\n        } catch (e) {\r\n            console.error('Redis read error:', e.message);\r\n        }\r\n    }\r\n    return [];\r\n}\r\n\r\nasync function saveCasos(casos) {\r\n    const redis = getRedis();\r\n    if (redis) {\r\n        await redis.set(KV_KEY, JSON.stringify(casos));\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction storageMode() {\r\n    return isRedisConfigured() ? 'upstash-redis' : 'memory';\r\n}\r\n\r\nmodule.exports = { getCasos, saveCasos, storageMode };\r\n"],"names":[],"mappings":"AAAA;;;;CAIC,GACD,MAAM,EAAE,KAAK,EAAE;AAEf,MAAM,SAAS;AAEf,2CAA2C;AAC3C,SAAS;IACL,OAAO,CAAC,CAAC,CAAC,QAAQ,GAAG,CAAC,sBAAsB,IAAI,QAAQ,GAAG,CAAC,wBAAwB;AACxF;AAEA,SAAS;IACL,IAAI,CAAC,qBAAqB,OAAO;IACjC,OAAO,IAAI,MAAM;QACb,KAAK,QAAQ,GAAG,CAAC,sBAAsB;QACvC,OAAO,QAAQ,GAAG,CAAC,wBAAwB;IAC/C;AACJ;AAEA,eAAe;IACX,MAAM,QAAQ;IACd,IAAI,OAAO;QACP,IAAI;YACA,MAAM,OAAO,MAAM,MAAM,GAAG,CAAC;YAC7B,IAAI,MAAM,OAAO,MAAM,OAAO,CAAC,QAAQ,OAAO,KAAK,KAAK,CAAC;QAC7D,EAAE,OAAO,GAAG;YACR,QAAQ,KAAK,CAAC,qBAAqB,EAAE,OAAO;QAChD;IACJ;IACA,OAAO,EAAE;AACb;AAEA,eAAe,UAAU,KAAK;IAC1B,MAAM,QAAQ;IACd,IAAI,OAAO;QACP,MAAM,MAAM,GAAG,CAAC,QAAQ,KAAK,SAAS,CAAC;QACvC,OAAO;IACX;IACA,OAAO;AACX;AAEA,SAAS;IACL,OAAO,sBAAsB,kBAAkB;AACnD;AAEA,OAAO,OAAO,GAAG;IAAE;IAAU;IAAW;AAAY"}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USS-000/Documents/GitHub/SimCardio/app/api/casos/route.js"],"sourcesContent":["/**\r\n * app/api/casos/route.js\r\n */\r\nimport { NextResponse } from 'next/server';\r\n\r\nconst { getCasos, saveCasos } = require('@/lib/redis');\r\n\r\nexport async function GET() {\r\n    try {\r\n        const casos = await getCasos();\r\n        return NextResponse.json(casos);\r\n    } catch (err) {\r\n        console.error('GET /api/casos:', err);\r\n        return NextResponse.json({ error: 'Error al leer casos' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request) {\r\n    try {\r\n        const body = await request.json();\r\n        if (!Array.isArray(body)) {\r\n            return NextResponse.json({ error: 'Se esperaba un array de casos' }, { status: 400 });\r\n        }\r\n        await saveCasos(body);\r\n        return NextResponse.json({ success: true, count: body.length });\r\n    } catch (err) {\r\n        console.error('POST /api/casos:', err);\r\n        return NextResponse.json({ error: 'Error al guardar casos' }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;CAEC,GACD;;AAEA,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE;AAEtB,eAAe;IAClB,IAAI;QACA,MAAM,QAAQ,MAAM;QACpB,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,KAAK;QACV,QAAQ,KAAK,CAAC,mBAAmB;QACjC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAsB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACJ;AAEO,eAAe,KAAK,OAAO;IAC9B,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,IAAI,CAAC,MAAM,OAAO,CAAC,OAAO;YACtB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAgC,GAAG;gBAAE,QAAQ;YAAI;QACvF;QACA,MAAM,UAAU;QAChB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,OAAO,KAAK,MAAM;QAAC;IACjE,EAAE,OAAO,KAAK;QACV,QAAQ,KAAK,CAAC,oBAAoB;QAClC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAyB,GAAG;YAAE,QAAQ;QAAI;IAChF;AACJ"}}]
}