module.exports=[18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},93631,a=>{a.v({app:"page-module__kqJ0Ja__app",backLink:"page-module__kqJ0Ja__backLink",blink:"page-module__kqJ0Ja__blink",brand:"page-module__kqJ0Ja__brand",brandDot:"page-module__kqJ0Ja__brandDot",brandName:"page-module__kqJ0Ja__brandName",brandTag:"page-module__kqJ0Ja__brandTag",btn:"page-module__kqJ0Ja__btn",btnDanger:"page-module__kqJ0Ja__btnDanger",btnFull:"page-module__kqJ0Ja__btnFull",btnGhost:"page-module__kqJ0Ja__btnGhost",btnPrimary:"page-module__kqJ0Ja__btnPrimary",btnSm:"page-module__kqJ0Ja__btnSm",btnSuccess:"page-module__kqJ0Ja__btnSuccess",caseItem:"page-module__kqJ0Ja__caseItem",caseItemActive:"page-module__kqJ0Ja__caseItemActive",caseList:"page-module__kqJ0Ja__caseList",caseMeta:"page-module__kqJ0Ja__caseMeta",caseName:"page-module__kqJ0Ja__caseName",caseNum:"page-module__kqJ0Ja__caseNum",chip:"page-module__kqJ0Ja__chip",chip_critical:"page-module__kqJ0Ja__chip_critical",chip_info:"page-module__kqJ0Ja__chip_info",chip_normal:"page-module__kqJ0Ja__chip_normal",chip_warning:"page-module__kqJ0Ja__chip_warning",deleteRowBtn:"page-module__kqJ0Ja__deleteRowBtn",editorContent:"page-module__kqJ0Ja__editorContent",editorHeader:"page-module__kqJ0Ja__editorHeader",editorHeaderLeft:"page-module__kqJ0Ja__editorHeaderLeft",editorLabel:"page-module__kqJ0Ja__editorLabel",editorPanel:"page-module__kqJ0Ja__editorPanel",ekgCell:"page-module__kqJ0Ja__ekgCell",ekgLink:"page-module__kqJ0Ja__ekgLink",emptyIcon:"page-module__kqJ0Ja__emptyIcon",emptyList:"page-module__kqJ0Ja__emptyList",emptyState:"page-module__kqJ0Ja__emptyState",fileBtn:"page-module__kqJ0Ja__fileBtn",loader:"page-module__kqJ0Ja__loader",mainGrid:"page-module__kqJ0Ja__mainGrid",modal:"page-module__kqJ0Ja__modal",modalActions:"page-module__kqJ0Ja__modalActions",modalIcon:"page-module__kqJ0Ja__modalIcon",modalOverlay:"page-module__kqJ0Ja__modalOverlay",noStages:"page-module__kqJ0Ja__noStages",pacienteInput:"page-module__kqJ0Ja__pacienteInput",pulse:"page-module__kqJ0Ja__pulse",rhythmSelect:"page-module__kqJ0Ja__rhythmSelect",searchInput:"page-module__kqJ0Ja__searchInput",sidebar:"page-module__kqJ0Ja__sidebar",sidebarFooter:"page-module__kqJ0Ja__sidebarFooter",sidebarHeader:"page-module__kqJ0Ja__sidebarHeader",sidebarTitle:"page-module__kqJ0Ja__sidebarTitle",slideIn:"page-module__kqJ0Ja__slideIn",stageBadge:"page-module__kqJ0Ja__stageBadge",stageNum:"page-module__kqJ0Ja__stageNum",stagesCount:"page-module__kqJ0Ja__stagesCount",stagesLeft:"page-module__kqJ0Ja__stagesLeft",stagesSection:"page-module__kqJ0Ja__stagesSection",stagesTable:"page-module__kqJ0Ja__stagesTable",stagesTitle:"page-module__kqJ0Ja__stagesTitle",stagesToolbar:"page-module__kqJ0Ja__stagesToolbar",tInput:"page-module__kqJ0Ja__tInput",tTextarea:"page-module__kqJ0Ja__tTextarea",tableWrapper:"page-module__kqJ0Ja__tableWrapper",toast:"page-module__kqJ0Ja__toast",toastContainer:"page-module__kqJ0Ja__toastContainer",toast_error:"page-module__kqJ0Ja__toast_error",toast_info:"page-module__kqJ0Ja__toast_info",toast_success:"page-module__kqJ0Ja__toast_success",topbar:"page-module__kqJ0Ja__topbar",topbarLeft:"page-module__kqJ0Ja__topbarLeft",vitalBp:"page-module__kqJ0Ja__vitalBp",vitalCapno:"page-module__kqJ0Ja__vitalCapno",vitalCell:"page-module__kqJ0Ja__vitalCell",vitalGlu:"page-module__kqJ0Ja__vitalGlu",vitalHr:"page-module__kqJ0Ja__vitalHr",vitalSpo2:"page-module__kqJ0Ja__vitalSpo2"})},59503,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(93631);let f=[{value:"RITMO_SINUSAL",label:"Ritmo Sinusal",chip:"normal"},{value:"BRADICARDIA_SINUSAL",label:"Bradicardia Sinusal",chip:"warning"},{value:"TAQUICARDIA_SUPRAVENTRICULAR",label:"Taquicardia SVT",chip:"warning"},{value:"FIBRILACION_AURICULAR",label:"FibrilaciÃ³n Auricular",chip:"warning"},{value:"BLOQUEO_AV_GRADO_1",label:"Bloqueo AV Grado 1",chip:"info"},{value:"BLOQUEO_AV_2_MOBITZ_1",label:"Bloqueo AV Mobitz I",chip:"warning"},{value:"TAQUICARDIA_VENTRICULAR",label:"Taquicardia Ventricular",chip:"critical"},{value:"FIBRILACION_VENTRICULAR",label:"FibrilaciÃ³n Ventricular",chip:"critical"},{value:"ASISTOLIA",label:"Asistolia",chip:"critical"},{value:"INFARTO_AGUDO_MIOCARDIO",label:"Infarto Agudo (IAM)",chip:"critical"}];function g(a){return f.find(b=>b.value===a)||{label:a,chip:"info"}}function h({value:a}){if(!a)return null;let c=g(a);return(0,b.jsx)("span",{className:`${e.default.chip} ${e.default[`chip_${c.chip}`]}`,children:c.label})}function i({toasts:a}){return(0,b.jsx)("div",{className:e.default.toastContainer,children:a.map(a=>(0,b.jsxs)("div",{className:`${e.default.toast} ${e.default[`toast_${a.type}`]}`,children:["success"===a.type&&"âœ“ ","error"===a.type&&"âœ• ","info"===a.type&&"â„¹ ",a.message]},a.id))})}function j(){let[a,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(-1),[j,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(!0),{toasts:s,show:t}=function(){let[a,b]=(0,c.useState)([]);return{toasts:a,show:(0,c.useCallback)((a,c="success")=>{let d=Date.now();b(b=>[...b,{id:d,message:a,type:c}]),setTimeout(()=>b(a=>a.filter(a=>a.id!==d)),3e3)},[])}}(),u=(0,c.useRef)(null);(0,c.useEffect)(()=>{fetch("/api/casos").then(a=>a.json()).then(a=>{f(Array.isArray(a)?a:[]),r(!1)}).catch(()=>{t("Error al cargar los casos","error"),r(!1)})},[]),(0,c.useEffect)(()=>{let a=a=>{(a.ctrlKey||a.metaKey)&&"s"===a.key&&(a.preventDefault(),A())};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[a]);let v=g>=0?a[g]:null,w=a.map((a,b)=>b).filter(b=>!j||a[b].paciente.toLowerCase().includes(j.toLowerCase()));function x(a){f(b=>b.map((b,c)=>c!==g?b:{...b,etapas:b.etapas.filter((b,c)=>c!==a)}))}function y(a,b,c){f(d=>d.map((d,e)=>e!==g?d:{...d,etapas:d.etapas.map((d,e)=>e===a?{...d,[b]:c}:d)}))}async function z(a,b){if(!a)return;t("Subiendo imagenâ€¦","info");let c=new FormData;c.append("ekgImage",a);try{let a=await fetch("/api/upload",{method:"POST",body:c}),d=await a.json();a.ok?(y(b,"ekg12d",d.filePath),t("Imagen subida correctamente","success")):t("Error al subir imagen","error")}catch{t("Error de conexiÃ³n al subir","error")}}async function A(){n(!0);try{(await fetch("/api/casos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok?t("Cambios guardados correctamente","success"):t("Error al guardar","error")}catch{t("Error de conexiÃ³n al guardar","error")}finally{n(!1)}}return(0,b.jsxs)("div",{className:e.default.app,children:[(0,b.jsxs)("header",{className:e.default.topbar,children:[(0,b.jsxs)("div",{className:e.default.topbarLeft,children:[(0,b.jsx)(d.default,{href:"/",className:e.default.backLink,children:"â† MenÃº"}),(0,b.jsxs)("div",{className:e.default.brand,children:[(0,b.jsx)("span",{className:e.default.brandDot}),(0,b.jsx)("span",{className:e.default.brandName,children:"SimCardio"}),(0,b.jsx)("span",{className:e.default.brandTag,children:"MANTENIMIENTO"})]})]}),(0,b.jsx)("button",{className:`${e.default.btn} ${e.default.btnSuccess}`,onClick:A,disabled:m,children:m?"â³ Guardandoâ€¦":"ðŸ’¾ Guardar Cambios"})]}),(0,b.jsxs)("div",{className:e.default.mainGrid,children:[(0,b.jsxs)("aside",{className:e.default.sidebar,children:[(0,b.jsxs)("div",{className:e.default.sidebarHeader,children:[(0,b.jsx)("span",{className:e.default.sidebarTitle,children:"Casos ClÃ­nicos"}),(0,b.jsx)("input",{className:e.default.searchInput,type:"text",placeholder:"ðŸ” Buscar caso...",value:j,onChange:a=>l(a.target.value)})]}),(0,b.jsxs)("div",{className:e.default.caseList,children:[q&&(0,b.jsxs)("div",{className:e.default.loader,children:[(0,b.jsx)("span",{}),"Cargando..."]}),!q&&0===w.length&&(0,b.jsx)("div",{className:e.default.emptyList,children:"Sin resultados"}),!q&&w.map(c=>(0,b.jsxs)("div",{className:`${e.default.caseItem} ${c===g?e.default.caseItemActive:""}`,onClick:()=>{h(c)},children:[(0,b.jsxs)("div",{className:e.default.caseNum,children:["Caso ",c+1]}),(0,b.jsx)("div",{className:e.default.caseName,children:a[c].paciente.length>65?a[c].paciente.slice(0,65)+"â€¦":a[c].paciente}),(0,b.jsx)("div",{className:e.default.caseMeta,children:(0,b.jsxs)("span",{className:e.default.stageBadge,children:[a[c].etapas?.length??0," etapa",a[c].etapas?.length!==1?"s":""]})})]},c))]}),(0,b.jsx)("div",{className:e.default.sidebarFooter,children:(0,b.jsx)("button",{className:`${e.default.btn} ${e.default.btnPrimary} ${e.default.btnFull}`,onClick:function(){let b={paciente:"Nuevo Caso ClÃ­nico",etapas:[]};f(a=>[...a,b]),h(a.length),l("")},children:"+ Nuevo Caso"})})]}),(0,b.jsxs)("main",{className:e.default.editorPanel,children:[!v&&(0,b.jsxs)("div",{className:e.default.emptyState,children:[(0,b.jsx)("span",{className:e.default.emptyIcon,children:"ðŸ“‹"}),(0,b.jsx)("h3",{children:"Selecciona un caso"}),(0,b.jsx)("p",{children:"Elige un caso de la lista o crea uno nuevo"})]}),v&&(0,b.jsxs)("div",{className:e.default.editorContent,children:[(0,b.jsxs)("div",{className:e.default.editorHeader,children:[(0,b.jsxs)("div",{className:e.default.editorHeaderLeft,children:[(0,b.jsxs)("div",{className:e.default.editorLabel,children:["CASO #",g+1," â€” DescripciÃ³n del Paciente"]}),(0,b.jsx)("textarea",{className:e.default.pacienteInput,rows:2,value:v.paciente,onChange:a=>{var b;return b=a.target.value,void f(a=>a.map((a,c)=>c===g?{...a,paciente:b}:a))},placeholder:"DescripciÃ³n clÃ­nica del paciente..."})]}),(0,b.jsx)("button",{className:`${e.default.btn} ${e.default.btnDanger} ${e.default.btnSm}`,onClick:()=>p(!0),children:"ðŸ—‘ Eliminar Caso"})]}),(0,b.jsxs)("div",{className:e.default.stagesSection,children:[(0,b.jsxs)("div",{className:e.default.stagesToolbar,children:[(0,b.jsxs)("div",{className:e.default.stagesLeft,children:[(0,b.jsx)("span",{className:e.default.stagesTitle,children:"Etapas"}),(0,b.jsx)("span",{className:e.default.stagesCount,children:v.etapas?.length??0})]}),(0,b.jsx)("button",{className:`${e.default.btn} ${e.default.btnGhost} ${e.default.btnSm}`,onClick:function(){f(a=>a.map((a,b)=>b!==g?a:{...a,etapas:[...a.etapas,{infoAdicional:"",bp:"",spo2:"",capno:"",hr:"",glucose:"",ritmo:"RITMO_SINUSAL"}]})),setTimeout(()=>{u.current?.lastElementChild?.scrollIntoView({behavior:"smooth"})},50)},children:"+ Agregar Etapa"})]}),(0,b.jsxs)("div",{className:e.default.tableWrapper,children:[(0,b.jsxs)("table",{className:e.default.stagesTable,children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"#"}),(0,b.jsx)("th",{children:"DescripciÃ³n / Info Adicional"}),(0,b.jsx)("th",{children:"â¤ï¸ HR"}),(0,b.jsx)("th",{children:"ðŸ©¸ BP"}),(0,b.jsx)("th",{children:"ðŸ’§ SpOâ‚‚"}),(0,b.jsx)("th",{children:"ðŸ« EtCOâ‚‚"}),(0,b.jsx)("th",{children:"ðŸ¬ Glu"}),(0,b.jsx)("th",{children:"âš¡ Ritmo"}),(0,b.jsx)("th",{children:"ðŸ–¼ EKG 12D"}),(0,b.jsx)("th",{})]})}),(0,b.jsx)("tbody",{ref:u,children:v.etapas?.map((a,c)=>(0,b.jsx)(k,{idx:c,etapa:a,onChange:y,onRemove:x,onUpload:z},c))})]}),v.etapas?.length===0&&(0,b.jsx)("div",{className:e.default.noStages,children:'Sin etapas â€” haz clic en "+ Agregar Etapa"'})]})]})]})]})]}),o&&(0,b.jsx)("div",{className:e.default.modalOverlay,onClick:()=>p(!1),children:(0,b.jsxs)("div",{className:e.default.modal,onClick:a=>a.stopPropagation(),children:[(0,b.jsx)("div",{className:e.default.modalIcon,children:"ðŸ—‘"}),(0,b.jsx)("h3",{children:"Eliminar caso clÃ­nico"}),(0,b.jsx)("p",{children:"Esta acciÃ³n es irreversible. Â¿Deseas eliminar el caso y todas sus etapas?"}),(0,b.jsxs)("div",{className:e.default.modalActions,children:[(0,b.jsx)("button",{className:`${e.default.btn} ${e.default.btnGhost}`,onClick:()=>p(!1),children:"Cancelar"}),(0,b.jsx)("button",{className:`${e.default.btn} ${e.default.btnDanger}`,onClick:function(){p(!1),f(a=>a.filter((a,b)=>b!==g)),h(-1),t("Caso eliminado","info")},children:"SÃ­, eliminar"})]})]})}),(0,b.jsx)(i,{toasts:s})]})}function k({idx:a,etapa:c,onChange:d,onRemove:i,onUpload:j}){return g(c.ritmo),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:e.default.stageNum,children:a+1}),(0,b.jsx)("td",{children:(0,b.jsx)("textarea",{className:e.default.tTextarea,rows:2,defaultValue:c.infoAdicional||"",onBlur:b=>d(a,"infoAdicional",b.target.value),placeholder:"DescripciÃ³n de la etapa..."})}),[{field:"hr",cls:"vitalHr"},{field:"bp",cls:"vitalBp"},{field:"spo2",cls:"vitalSpo2"},{field:"capno",cls:"vitalCapno"},{field:"glucose",cls:"vitalGlu"}].map(({field:f,cls:g})=>(0,b.jsx)("td",{className:e.default.vitalCell,children:(0,b.jsx)("input",{className:`${e.default.tInput} ${e.default[g]}`,defaultValue:c[f]||"",placeholder:"â€”",onBlur:b=>d(a,f,b.target.value)})},f)),(0,b.jsxs)("td",{children:[(0,b.jsxs)("select",{className:e.default.rhythmSelect,value:c.ritmo||"",onChange:b=>d(a,"ritmo",b.target.value),children:[(0,b.jsx)("option",{value:"",children:"â€” Sin ritmo â€”"}),f.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))]}),(0,b.jsx)(h,{value:c.ritmo})]}),(0,b.jsxs)("td",{className:e.default.ekgCell,children:[c.ekg12d&&(0,b.jsx)("a",{href:c.ekg12d,target:"_blank",rel:"noreferrer",className:e.default.ekgLink,children:"ðŸ–¼ Ver imagen"}),(0,b.jsxs)("label",{className:e.default.fileBtn,children:["ðŸ“¤ ",c.ekg12d?"Cambiar":"Subir ECG",(0,b.jsx)("input",{type:"file",accept:"image/*",style:{display:"none"},onChange:b=>j(b.target.files?.[0],a)})]})]}),(0,b.jsx)("td",{children:(0,b.jsx)("button",{className:e.default.deleteRowBtn,onClick:()=>i(a),title:"Eliminar etapa",children:"âœ•"})})]})}a.s(["default",()=>j])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__471d98fe._.js.map