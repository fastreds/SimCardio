<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Signos Vitales</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/interact.js/1.10.11/interact.min.js"></script>
    <style>
        body { 
            background-color: black;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            flex-direction: column;
            text-align: center;
        }

        .container {
            width: 90%;
            max-width: 600px;
            background-color: #222;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            font-size: 1.8em;
            position: absolute;
            cursor: grab;
            box-shadow: 0px 0px 15px rgba(255, 255, 255, 0.2);
        }

        p {
            font-weight: bold;
            font-size: 2.5em;
            background-color: black;
            display: inline-block;
            padding: 10px;
            border-radius: 5px;
        }

        /* Contenedores de signos vitales con colores distintivos */
        #ecg-container { border: 3px solid red; top: 10%; left: 5%; }
        #blood-pressure-container { border: 3px solid blue; top: 30%; left: 5%; }
        #spo2-container { border: 3px solid green; top: 50%; left: 5%; }
        #capnometry-container { border: 3px solid yellow; top: 70%; left: 5%; }
        #heart-rate-container { border: 3px solid orange; top: 90%; left: 5%; }

        /* Estilos de los botones */
        button {
            margin-top: 10px;
            padding: 15px;
            background-color: green;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 1.5em;
            border-radius: 10px;
            transition: background 0.3s;
        }

        button:hover { background-color: darkgreen; }
    </style>
</head>
<body>
    <div id="ecg-container" class="container">
        <h3>Electrocardiograma (ECG)</h3>
        <canvas id="ecg-canvas"></canvas>
    </div>
    <div id="blood-pressure-container" class="container">
        <h3>Presión Arterial</h3>
        <p id="bp-value" style="color: blue;">120/80 mmHg</p>
    </div>
    <div id="spo2-container" class="container">
        <h3>Oximetría</h3>
        <p id="spo2-value" style="color: green;">98% SpO2</p>
    </div>
    <div id="capnometry-container" class="container">
        <h3>Capnometría</h3>
        <p id="capno-value" style="color: yellow;">35 mmHg</p>
    </div>
    <div id="heart-rate-container" class="container">
        <h3>Frecuencia Cardíaca</h3>
        <p id="hr-value" style="color: orange;">75 BPM</p>
    </div>
    
    <button onclick="startSimulation()">Iniciar Simulación</button>
    <button onclick="resetPositions()">Restablecer Posiciones</button>

    <script>
        // Función para obtener valores aleatorios en un rango dado
        function getRandomValue(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        // Función para actualizar los signos vitales cada 3 segundos con animación
        function updateParameters() {
            gsap.to("#bp-value", { textContent: `${getRandomValue(110, 130)}/${getRandomValue(70, 90)} mmHg`, duration: 1, ease: "power2.out" });
            gsap.to("#spo2-value", { textContent: `${getRandomValue(95, 100)}% SpO2`, duration: 1, ease: "power2.out" });
            gsap.to("#capno-value", { textContent: `${getRandomValue(30, 45)} mmHg`, duration: 1, ease: "power2.out" });
            gsap.to("#hr-value", { textContent: `${getRandomValue(60, 100)} BPM`, duration: 1, ease: "power2.out" });
        }

        // Inicia la simulación de actualización automática
        function startSimulation() {
            setInterval(updateParameters, 3000);
            alert('Simulación iniciada');
        }

        // Configurar elementos como arrastrables y guardar su posición en localStorage
        interact('.container').draggable({
            inertia: true,
            modifiers: [
                interact.modifiers.snap({
                    targets: [interact.snappers.grid({ x: 50, y: 50 })],
                    range: Infinity,
                    relativePoints: [{ x: 0.5, y: 0.5 }]
                })
            ],
            listeners: {
                move(event) {
                    let target = event.target;
                    let x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
                    let y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
                    target.style.transform = `translate(${x}px, ${y}px)`;
                    target.setAttribute('data-x', x);
                    target.setAttribute('data-y', y);
                    localStorage.setItem(target.id, JSON.stringify({ x, y }));
                }
            }
        });

        // Restaurar posiciones guardadas al recargar la página
        window.onload = function() {
            document.querySelectorAll('.container').forEach(el => {
                let savedPosition = JSON.parse(localStorage.getItem(el.id));
                if (savedPosition) {
                    el.style.transform = `translate(${savedPosition.x}px, ${savedPosition.y}px)`;
                    el.setAttribute('data-x', savedPosition.x);
                    el.setAttribute('data-y', savedPosition.y);
                }
            });
        };

        // Restablece las posiciones a su estado inicial
        function resetPositions() {
            document.querySelectorAll('.container').forEach(el => {
                el.style.transform = "translate(0,0)";
                el.setAttribute('data-x', 0);
                el.setAttribute('data-y', 0);
                localStorage.removeItem(el.id);
            });
        }
    </script>
</body>
</html>
